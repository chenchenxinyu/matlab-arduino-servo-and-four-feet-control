# 四组蜘蛛笔记

*本项目希望自主开发一个完成度比较高的产品，所以各个部分希望能够独立完成，做好笔记，以便后期分享*

## 步态问题

*步态参数的设定需要在合理的基础上加入换算和控制元素。*

四足步态描述：

移动：后左腿顺时针旋转于其他三条腿达到支持，前左腿旋转向前迈步拉伸，后右腿抬起，重心转移到新的三条腿，右前腿抬起重心偏移

关键在建立的三条腿的三角形重心位置偏移  抬起是需要对角线的腿乡下控制重心

![image-20211012182715839](https://i.loli.net/2021/10/12/4NzFXaTmwlD9pnk.png)



*能够来回形成波形螺旋向前，类似于丝杆的原理最好腰部能配合运动*

自然界设计：

横纹金蛛和络新妇

#### 步态分析

![1634436225137](https://i.loli.net/2021/10/17/KixyRujZh5Xv4qb.jpg)

#### 站立

|       | 腿1  | 腿2  | 3    | 4    |
| ----- | ---- | ---- | ---- | ---- |
| 关节1 | 45   | 45   | 45   | 45   |
| 关节2 | 135  | 45   | 135  | 45   |
| 关节3 | 30   | 0    | 30   | 0    |



#### 参考算法：

加入定时器  舵机初始角度设定速度必须要快  复位可能导致错误

舵机编号和关节采用3*4数组进行  部分运动需要单关节操作

每条腿和关节对应到状态，反复套用很多函数，逻辑虽然清晰，但是缺少多文件编程，只写了步态和不同模式，缺少蓝牙控制，内网控制，信息交互，传感器数据反馈，必要时考虑加入pid维持平衡。



### 关节控制

十二个SG90是180度舵机，pwm调制范围0-180，建议学习底层控制，注意舵机初始位置。

大腿向前，初始角度0度

中腿向前，初始角度90度

爪子向前，初始角度0度

*2021.10.7*

在设置初始角度的时候，存在供电不足的问题，而且大腿部分出现归零，复位之后wrie0的情况，不知道如何解释

解决思路：

- 准备下电源管理，怎么单独给舵机供电，不要给开发板太大的负担
- 了解下pwm的控制原理，舵机到底是怎么运行的，尤其是舵机控制板，认识不同引脚的数字信号好其他信号有什么区别
- ![image-20211007155359296](https://i.loli.net/2021/10/07/PYOVauH4TWwd1sn.png)
- ![image-20211007180641733](https://i.loli.net/2021/10/07/C5mM2YnRwUXhT9B.png)
- 说明：

#### 引脚说明紫色名称的代表数字功能，绿色名称的代表模拟功能，深灰色部分代表对应的微控制328P的芯片引脚，

A6、A7只能做模拟功能。

A4、A5除模拟功能外，可以做IO用，也可以做I2C总线用

D10到D13，可以做SPI总线用

D3、D5、D6、D9、D10、D11 可以做PWM输出用。

注意：每个引脚只能用作一个用途，比如用了SPI总线后，D10、D11就不可以再做PWM用。
基本上常用到的功能就这么多了，如果需要了解更多，请参阅328P官方的[手册](http://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-7810-Automotive-Microcontrollers-ATmega328P_Datasheet.pdf)

- 电源引脚  GND和VCC
- 复位引脚：

在单片机接通电源后， 为了使内部电路正常工作， 需要复位电路为它提供复位信号，使内部电路进入初始状态， 然后才开始工作。 MCS-51 系列单片机采用高电平复位， 即外接复位电路给复位引脚送入高电平信号后， 就可以对单片机内部电路进行复位。

- 模拟输入引脚  8个

模拟接口只能读取不能输出模拟量（其实也可以输出，不过只能输出 5V 和 0V，并且模拟接口输出的是 CMOS 信号而非数字接口那种 TTL 信号）

模拟接口里面的模数转换器用的是一个 10 位二进制空间

对于除 Mega 开发板以外的 Arduino 开发板，当您使用 Servo 库时，开发板的 9 号和 10 号引脚的 PWM 功能是无法使用的。也就是说，您的 Arduino 程序如果使用了 Servo 库，无论 9 号和 10 号引脚上是否连接了舵机，那么这两个引脚是不能使用 analogWrite() 语句进行控制的。

对于 Mega 开发板，使用 12 个以下的舵机是不会影响开发板的 PWM 功能的。但如果使用 12 个以上的舵机，那么 Mega 开发板上的引脚 11 和引脚 12 是要受到影响的。

**用模拟接口接收传感器信号**

Arduino 模拟接口可输入的电平最高就是 5V，再高就会烧坏板子，所以在开发过程中需要确认传感器传入的电平高低，太高了就要降压。

- 数字IO  22个

也就是高低电平，引脚

- PWM 6个

调制模拟信号，来回高低电平调节占空比，一般有些数字IO可以实现这个功能

- RX  TX

TX，RX 灯：这两个灯和串口通信有关，TX 闪说明 Arduino 正通过串口通信发送信息，RX 闪说明 Arduino 正通过串口通信接受信息。





## 电源管理问题

*问题描述*：

十二个舵机需要单独供电，单片机也需要单独供电，加上续航的问题，需要自己设计稳压降压电路，实现长续航和控制，做好充电和电量显示装置

## 多路舵机控制

借用舵机扩展版实现了一些功能，建议了解如何进行输出PWM信号，以及舵机控制板的原理

升级版可以采用电机simpleFOC控制，效果会比舵机更好，但是涉及到顶层也更加深入

### 舵机简介
数字舵机和模拟舵机的最大区别则体现在控制电路上，数字舵机的控制电路比模拟舵机的多了**微处理器**和**晶振**。

①处理接收机的输入信号的方式；

②控制舵机马达初始电流的方式，减少无反应区 (对小量信号无反应的控制区域)，增加分辨率以及产生更大的固定力量。

③实际应用不同，数字舵机在位置准确度方面要高于模拟舵机。在同样标称 1.6 公斤的舵机面前数字舵机在实际表现中会感觉更加 “力气大” 而模拟舵机就会 “肉” 点。模拟舵机由于控制芯片是模拟电路，所以即便是相同型号的舵机会存在小小的性能差异，而数字舵机在一致性方面就非常好。



    writeMicroseconds()  控制舵机，1500位于中间，1000和2000是逆时针和顺时针

## 指南针和MPU姿态感知

*说明：*

姿态感知的要素和融合方式，实现途径调整

**位置信息能否借助GPS做远程定位，或者说有没有存在的意义**

## 蓝牙控制

蓝牙控制的原理是什么，能否采用接收机控制，或者采用红外进行遥控

**蓝牙控制或者wifi控制应该注意网络和通信方面的深入研究**



## 整体平衡问题

能够采用动量轮维持平衡

## 视觉分析和雷达感知

采用激光雷达和ROS

### matlab开发深度学习

1. 借助硬件支持包配合树莓派

为了使用 MATLAB/Simulink 开发和部署任何深度学习应用程序到 Raspberry Pi，存在对 ARM® Compute 库的依赖。

[RaspbianInstallARMComputeLib.sh](https://github.com/chenchenxinyu/Raspbian_OS_Setup/blob/master/RaspbianInstallARMComputeLib.sh)是一个脚本，用于在 Raspberry Pi 硬件上安装和配置 ARM Compute 库 v19.05。

要使用此脚本，请将此文件复制到您的 Raspberry Pi 硬件并运行 shell 脚本。安装成功后，重启你的树莓派。

1. 



## 外加机械臂扩展

机械臂的功能

